<!doctype html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:shiro="http://www.pollix.at/thymeleaf/shiro">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>è´¦å·ç®¡ç†</title>
    <meta name="description" content="è´¦å·ç®¡ç†">
    <meta name="keywords" content="index">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="renderer" content="webkit">
    <meta http-equiv="Cache-Control" content="no-siteapp" />
    <link rel="icon" type="image/png" href="/assets/i/favicon.png">
    <link rel="apple-touch-icon-precomposed" href="/assets/i/app-icon72x72@2x.png">
    <meta name="apple-mobile-web-app-title" content="Amaze UI" />
    <link rel="stylesheet" href="/assets/css/amazeui.min.css" />
    <link rel="stylesheet" href="/assets/css/admin.css">
    <link rel="stylesheet" href="/assets/css/app.css">
    <script src="/assets/js/echarts.min.js"></script>
    <script src="/js/jquery-1.11.0.min.js"></script>
    <style>
        #sub:hover{
            cursor:pointer;
        }
        #sub{
            display: block;
            width:99%;
            height:80%;
        }
    </style>
</head>

<body data-type="generalComponents" >

    <!--é¡¶éƒ¨-->
    <header class="am-topbar am-topbar-inverse admin-header">
        <div class="am-topbar-brand">
            <a href="javascript:;" class="tpl-logo">
                <img src="/assets/img/shoeslogo.png" alt="">
            </a>
        </div>
        <div class="am-icon-list tpl-header-nav-hover-ico am-fl am-margin-right">

        </div>

        <button class="am-topbar-btn am-topbar-toggle am-btn am-btn-sm am-btn-success am-show-sm-only" data-am-collapse="{target: '#topbar-collapse'}"><span class="am-sr-only">å¯¼èˆªåˆ‡æ¢</span> <span class="am-icon-bars"></span></button>

        <div class="am-collapse am-topbar-collapse" id="topbar-collapse" >

            <ul class="am-nav am-nav-pills am-topbar-nav am-topbar-right admin-header-list tpl-header-list">
                <li class="am-hide-sm-only"><a href="javascript:;" id="admin-fullscreen" class="tpl-header-list-link"><span class="am-icon-arrows-alt"></span> <span class="admin-fullText">å¼€å¯å…¨å±</span></a></li>
                <li class="am-dropdown" data-am-dropdown data-am-dropdown-toggle>
                    <a class="am-dropdown-toggle tpl-header-list-link" href="javascript:;">
                        <span class="tpl-header-list-user-nick">
                            <shiro:user>
                                <shiro:principal/>
                            </shiro:user>
                        </span>
                        <span class="tpl-header-list-user-ico"></span>ğŸ‘¨
                    </a>
                    <ul class="am-dropdown-content">
                        <li id="updatePwd"><a href="#"><span class="am-icon-cog"></span> ä¿®æ”¹å¯†ç </a></li>
                        <li><a href="/adminController/Exit"><span class="am-icon-power-off"></span> é€€å‡º</a></li>
                    </ul>
                </li>
                <li><a href="/adminController/Exit" class="tpl-header-list-link" style="background:#E1E3EA;"><span class="am-icon-sign-out tpl-header-list-ico-out-size"></span></a></li>
            </ul>
        </div>
    </header>

    <div class="tpl-page-container tpl-page-header-fixed">

        <!--å·¦ä¾§åˆ—è¡¨-->
        <div class="tpl-left-nav tpl-left-nav-hover">
            <div class="tpl-left-nav-list">
                <ul class="tpl-left-nav-menu">

                    <li class="tpl-left-nav-item">
                        <a href="/adminController/SuccessIndex" class="nav-link tpl-left-nav-link-list">
                            <i class="am-icon-home"></i>
                            <span>é¦–é¡µ</span>
                        </a>
                    </li>

                    <li class="tpl-left-nav-item">
                        <a href="javascript:;" class="nav-link tpl-left-nav-link-list">
                            <i class="am-icon-user"></i>
                            <span>ç®¡ç†å‘˜</span>
                            <i class="am-icon-angle-right tpl-left-nav-more-ico am-fr am-margin-right"></i> <!--æ–°æ¶ˆæ¯æç¤º-->
                        </a>
                        <ul class="tpl-left-nav-sub-menu" style="display: block;">
                            <li>
                                <a href="/adminController/AdminManageIndex" class="active">
                                    <i class="am-icon-angle-right"></i>
                                    <span>è´¦æˆ·ç®¡ç†</span>
                                    <i class="tpl-left-nav-content-ico am-fr am-margin-right"></i>
                                </a>
                            </li>
                        </ul>
                    </li>
                    <li class="tpl-left-nav-item">
                        <a href="javascript:;" class="nav-link tpl-left-nav-link-list">
                            <i class="am-icon-table"></i>
                            <span>å®¢æˆ·ç®¡ç†</span>
                            <i class="am-icon-angle-right tpl-left-nav-more-ico am-fr am-margin-right"></i>
                        </a>
                        <ul class="tpl-left-nav-sub-menu">
                            <li>
                                <!-- æ‰“å¼€çŠ¶æ€ a æ ‡ç­¾æ·»åŠ  active å³å¯   -->
                                <a href="/show_customer_info.html" class="active">
                                    <i class="am-icon-angle-right"></i>
                                    <span>å®¢æˆ·ä¿¡æ¯</span>
                                </a>
                                <a href="/show_recharge_record.html">
                                    <i class="am-icon-angle-right"></i>
                                    <span>å……å€¼è®°å½•</span>
                                </a>
                                <a href="/show_expense_record.html">
                                    <i class="am-icon-angle-right"></i>
                                    <span>æ¶ˆè´¹è®°å½•</span>
                                </a>
                            </li>
                        </ul>
                    </li>

                </ul>
            </div>
        </div>

        <div class="tpl-content-wrapper">
            <ol class="am-breadcrumb">
                <li><a href="javascript:;" class="am-icon-home">ç®¡ç†å‘˜</a></li>
                <li><a href="javascript:;">è´¦æˆ·ç®¡ç†</a></li>
                <li class="am-active">å†…å®¹</li>
            </ol>
            <div class="tpl-portlet-components">
                <div class="tpl-block">
                    <div class="am-g">
                        <div class="am-u-sm-12 am-u-md-3">
                            <div class="am-btn-toolbar">
                                <shiro:hasAnyRoles name = "è¶…çº§ç®¡ç†å‘˜">
                                <div class="am-btn-group am-btn-group-xs">
                                    <button type="button" class="am-btn am-btn-default am-btn-success add"><span class="am-icon-plus"></span> æ–°å¢</button>
                                </div>
                            </shiro:hasAnyRoles>
                                <shiro:lacksRole name = "è¶…çº§ç®¡ç†å‘˜">
                                    <div class="am-btn-group am-btn-group-xs">
                                        <button type="button" class="am-btn am-btn-default am-btn-success noadd"><span class="am-icon-plus"></span> æ–°å¢</button>
                                        <script>
                                            $(".noadd").click(function(){
                                               alert("æŠ±æ­‰ï¼Œä½ æ²¡æœ‰æ–°å¢æƒé™");
                                            });
                                        </script>
                                    </div>
                                </shiro:lacksRole>
                            </div>
                        </div>
                        <div class="am-u-sm-12 am-u-md-3">
                            <div class="am-form-group">
                                <select data-am-selected="{btnSize: 'sm'}" id="selectState">
                                </select>
                            </div>
                        </div>
                        <div class="am-u-sm-12 am-u-md-3">
                            <div class="tpl-portlet-input tpl-fz-ml">
                                <div class="portlet-input input-small input-inline">
                                    <div class="input-icon right">
                                        <i class="am-icon-search"></i>
                                        <input type="text" id="search" class="form-control form-control-solid" placeholder="æœç´¢...">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="am-g">
                        <div class="am-u-sm-12">
                            <form class="am-form">
                                <table class="am-table am-table-striped am-table-hover table-main">
                                    <thead>
                                    <tr>
                                        <th class="table-id">ID</th>
                                        <th class="table-title">å§“å</th>
                                        <th class="table-type">è´¦å·</th>
                                        <th >è”ç³»ç”µè¯</th>
                                        <th class="table-date am-hide-sm-only">æƒé™</th>
                                        <th class="table-date am-hide-sm-only">çŠ¶æ€</th>
                                        <th class="table-date am-hide-sm-only">ä¿®æ”¹äºº</th>
                                        <th class="table-date am-hide-sm-only">åˆ›å»ºæ—¶é—´</th>
                                        <th class="table-set">æ“ä½œ</th>
                                    </tr>
                                    </thead>
                                    <tbody id="content">
                                    <!--<tr>-->
                                        <!--<td><input type="checkbox"></td>-->
                                        <!--<td>1</td>-->
                                        <!--<td><a href="#">Business management</a></td>-->
                                        <!--<td>default</td>-->
                                        <!--<td class="am-hide-sm-only">2014å¹´9æœˆ4æ—¥ 7:28:47</td>-->
                                        <!--<td class="am-hide-sm-only">2014å¹´9æœˆ4æ—¥ 7:28:47</td>-->
                                        <!--<td class="am-hide-sm-only">2014å¹´9æœˆ4æ—¥ 7:28:47</td>-->
                                        <!--<td class="am-hide-sm-only">2014å¹´9æœˆ4æ—¥ 7:28:47</td>-->
                                        <!--<td>-->
                                            <!--<div class="am-btn-toolbar">-->
                                                <!--<div class="am-btn-group am-btn-group-xs">-->
                                                    <!--<button class="am-btn am-btn-default am-btn-xs am-text-secondary"><span class="am-icon-pencil-square-o"></span> ç¼–è¾‘</button>-->
                                                    <!--<button class="am-btn am-btn-default am-btn-xs am-text-danger am-hide-sm-only"><span class="am-icon-trash-o"></span> åˆ é™¤</button>-->
                                                <!--</div>-->
                                            <!--</div>-->
                                        <!--</td>-->
                                    <!--</tr>-->
                                    </tbody>
                                </table>
                                <div class="am-cf">

                                    <div class="am-fr">
                                        <ul class="am-pagination tpl-pagination" id="paging_toolbar">
                                            <li class="am-disabled" id="prev"><a href="#">Â«</a></li>
                                            <li class="am-active"><a href="#">1</a></li>
                                            <li><a href="#">2</a></li>
                                            <li><a href="#">3</a></li>
                                            <li><a href="#">4</a></li>
                                            <li><a href="#">5</a></li>
                                            <li><a href="#">Â»</a></li>
                                        </ul>
                                    </div>
                                </div>
                                <hr>

                            </form>
                        </div>

                    </div>
                </div>
                <div class="tpl-alert"></div>
            </div>

        </div>

    </div>

    <!--å³ä¸‹è§’æç¤ºä¿¡æ¯-->
    <style type="text/css">
        #hint{
            width:30%;
            height:auto;
            position:absolute;
            right:1.3%;
            top:0%;
            padding:0px;
        }
    </style>
    <div id="hint">
        <script>
            <!--åŠ¨æ€è®¾ç½®æç¤ºæ¡†çš„æœªçŸ¥-->
            $(function(){
                // $(window).scroll(function(){
                //     var scrollTopHeight=$(document).scrollTop();    //æ»šåŠ¨æ¡è·é¡¶éƒ¨çš„é«˜åº¦
                //     var documentHeight= document.body.clientHeight; //å¯è§æ–‡æ¡£é«˜åº¦
                //         $("#hint").css("top",scrollTopHeight+documentHeight*0.8+"px");
                // }) ;
            });
        </script>
    </div>

    <!--ä¿®æ”¹å¯†ç -->
    <div class="am-modal am-modal-prompt" tabindex="-1" id="consumption_model">
        <div class="am-modal-dialog">
            <div class="am-modal-bd">
                <form class="am-form am-form-horizontal" id="consumption_form">
                    <fieldset>
                        <legend>ä¿®æ”¹å¯†ç </legend>
                        <div  class="am-form-group">
                            <label class="am-u-sm-3 am-form-label">åŸå¯†ç </label>
                            <div class="am-u-sm-9">
                             <input name='oldPwd' type="password" id="oldPwd" placeholder="è¯·è¾“å…¥">
                             </div>
                           </div>
                       <div class="am-form-group">
                       <label class="am-u-sm-3 am-form-label">æ–°å¯†ç </label>
                        <div class="am-u-sm-9">
                        <input name='newPwd' type="password" id="newPwd" placeholder="è¯·è¾“å…¥6-16ä½æ•°å¯†ç ï¼ˆæ•°å­—åŠ å­—æ¯ï¼‰">
                       </div>
                        </div>
                    </fieldset>
                </form>
            </div>
            <div class="am-modal-footer">
                <span class="am-modal-btn" data-am-modal-cancel>å–æ¶ˆ</span>
                <span class="am-modal-btn" id="subUpdatePwd" data-am-modal-confirm>æäº¤</span>
            </div>
        </div>
    </div>


    <script src="/assets/js/jquery.min.js"></script>
    <script src="/assets/js/amazeui.min.js"></script>
    <script src="/assets/js/iscroll.js"></script>
    <script src="/assets/js/app.js"></script>
</body>

</html>
<script type="text/javascript">

    var stateId=""; //çŠ¶æ€id
    var condition=""; //æ¡ä»¶
    var page=1;
    var rows=3;
    var url="";

    //è¡¨å•ä¿¡æ¯
    function formInfo(adminId,adminName,adminAuthority,adminPhone){
        var str="<input type='hidden' id='adminId' name='adminId' value='"+adminId+"'><div style='margin-left:8%;' class=\"am-g tpl-amazeui-form\"><div class=\"am-u-sm-12 am-u-md-9\"><form class=\"am-form am-form-horizontal\">\n" +
            "                            <div id='accountDiv' class=\"am-form-group\">\n" +
            "                                <label for=\"user-name\" class=\"am-u-sm-3 am-form-label\">è´¦å·</label>\n" +
            "                                <div class=\"am-u-sm-9\">\n" +
            "                                    <input name='adminName' type=\"text\" id=\"account\" placeholder=\"è¯·è¾“å…¥4-16ä½æ•°è´¦å·ï¼ˆå­—æ¯ï¼Œæ•°å­—ï¼Œä¸‹åˆ’çº¿ï¼Œå‡å·ï¼‰\">\n" +
            "                                </div>\n" +
            "                            </div>" +
            "                            <div id='pwdDiv' class=\"am-form-group\">\n" +
            "                                <label for=\"user-name\" class=\"am-u-sm-3 am-form-label\">å¯†ç </label>\n" +
            "                                <div class=\"am-u-sm-9\">\n" +
            "                                    <input name='adminName' type=\"password\" id=\"password\" placeholder=\"è¯·è¾“å…¥6-16ä½æ•°å¯†ç ï¼ˆæ•°å­—åŠ å­—æ¯ï¼‰\">\n" +
            "                                </div>\n" +
            "                            </div>" +
            "                            <div class=\"am-form-group\">\n" +
            "                                <label for=\"user-name\" class=\"am-u-sm-3 am-form-label\">å§“å</label>\n" +
            "                                <div class=\"am-u-sm-9\">\n" +
            "                                    <input value='"+adminName+"' name='adminName' type=\"text\" id=\"adminName\" placeholder=\"è¯·è¾“å…¥ä¸­æ–‡åç§°æˆ–è‹±æ–‡åç§°\">\n" +
            "                                </div>\n" +
            "                            </div>" +
            "                            <div class=\"am-form-group\">\n" +
            "                                <label for=\"user-name\" class=\"am-u-sm-3 am-form-label\">æ‰‹æœºå·</label>\n" +
            "                                <div class=\"am-u-sm-9\">\n" +
            "                                    <input value='"+adminPhone+"' name='adminPhone' type=\"text\" id=\"adminPhone\" placeholder=\"è¯·è¾“å…¥æ­£ç¡®çš„æ‰‹æœºå·\">\n" +
            "                                </div>\n" +
            "                            </div>" +
            "<div class=\"am-form-group\">\n" +
            "                                <label for=\"user-phone\" class=\"am-u-sm-3 am-form-label\">æƒé™<span class=\"tpl-form-line-small-title\"></span></label>\n" +
            "                                <div class=\"am-u-sm-9\">\n" +
            "                                    <select id='adminAuthority' name='adminAuthority' data-am-selected=\"{searchBox: 1}\">\n";
        if(adminAuthority=="è¶…çº§ç®¡ç†å‘˜"){
            str+="                                        <option value=\"è¯·é€‰æ‹©\">è¯·é€‰æ‹©</option>\n" +
                "                                        <option value=\"è¶…çº§ç®¡ç†å‘˜\" selected>è¶…çº§ç®¡ç†å‘˜</option>\n" +
                "                                        <option value=\"æ™®é€šç®¡ç†å‘˜\">æ™®é€šç®¡ç†å‘˜</option>\n" +
                "                                    </select>\n" +
                "                                </div>\n" +
                "                            </div>" +
                "                        </form></div></div>\n";
        }else if(adminAuthority=="æ™®é€šç®¡ç†å‘˜"){
            str+="                                        <option value=\"è¯·é€‰æ‹©\">è¯·é€‰æ‹©</option>\n" +
                "                                        <option value=\"è¶…çº§ç®¡ç†å‘˜\">è¶…çº§ç®¡ç†å‘˜</option>\n" +
                "                                        <option value=\"æ™®é€šç®¡ç†å‘˜\" selected>æ™®é€šç®¡ç†å‘˜</option>\n" +
                "                                    </select>\n" +
                "                                </div>\n" +
                "                            </div>" +
                "                        </form></div></div>\n";
        }else{
            str+="                                        <option value=\"è¯·é€‰æ‹©\">è¯·é€‰æ‹©</option>\n" +
                "                                        <option value=\"è¶…çº§ç®¡ç†å‘˜\">è¶…çº§ç®¡ç†å‘˜</option>\n" +
                "                                        <option value=\"æ™®é€šç®¡ç†å‘˜\">æ™®é€šç®¡ç†å‘˜</option>\n" +
                "                                    </select>\n" +
                "                                </div>\n" +
                "                            </div>" +
                "                        </form></div></div>\n";
        }
        return str;
    }


    /**
     * æç¤ºä¿¡æ¯
     * */
    function prompt(str){
        $('.am-alert').alert('close');
        $("#hint").append("<div class=\"am-alert\" data-am-alert>\n" +
            "            <button type=\"button\" class=\"am-close\">&times;</button>\n" +
            "            <p>"+str+"</p>\n" +
        "        </div>");
        $('.am-alert').alert();
    }

    $(function(){

        /**
         * å…·æœ‰ç¡®è®¤æŒ‰é’®çš„æç¤ºæ¡†
         * @param state çŠ¶æ€
         * @param message ä¿¡æ¯
         */
        function show_alert(state,message)
        {
            $("#my_alert").remove();
            $("body").append("<div class='am-modal am-modal-alert' tabindex='-1' id='my_alert'><div style='width:650px;'  class='am-modal-dialog'><div class='am-modal-hd'>"+state+"</div><div class='am-modal-bd'>"+message+"</div><div class=\"am-modal-footer\">\n" +
                "            <span class=\"am-modal-btn\" id='cancel'>å–æ¶ˆ</span>\n" +
                "            <span id='sub'>æäº¤</span>\n" +
                "        </div></div></div>");
            $('#my_alert').modal();
            $("#sub").click(function(){
                var username = /^[\u4E00-\u9FA5A-Za-z]+$/; //å§“åï¼šä¸­æ–‡å’Œè‹±æ–‡
                var adminAuthority=$("#adminAuthority").val();
                var adminName=$("#adminName").val();
                if(url=="/adminController/add"){ //æ·»åŠ 
                    var account=$("#account").val();
                    var pwd=$("#password").val();
                    //æ­£åˆ™è¡¨è¾¾å¼
                    var uPattern = /^[a-zA-Z0-9_-]{4,16}$/; //è´¦å·ï¼šå­—æ¯ï¼Œæ•°å­—ï¼Œä¸‹åˆ’çº¿ï¼Œå‡å·
                    var pPattern=/^(?![0-9]+$)(?![a-zA-Z]+$)[0-9A-Za-z]{6,16}$/; //å¯†ç ï¼š6-16ä½å­—æ¯åŠ æ•°å­—
                    //åˆ¤æ–­è´¦æˆ·æ˜¯å¦å­˜åœ¨
                    var rs=false;
                    $.ajax({
                        url:"/adminController/checkAccount",
                        type:'post',
                        async:false,
                        data:{
                            account:account,
                        },
                        dataType:'text',
                        success:function(data) {
                            if(data=="true"){
                                rs=true;
                            }
                        }
                    });
                    if(rs){
                        alert("è´¦å·å·²å­˜åœ¨ï¼Œè¯·æ›´æ”¹ï¼");
                        return false;
                    }else if(!uPattern.test(account)){
                        alert("è¯·è¾“å…¥4-16ä½æ•°è´¦å·ï¼ˆå­—æ¯ï¼Œæ•°å­—ï¼Œä¸‹åˆ’çº¿ï¼Œå‡å·ï¼‰ï¼");
                        return false;
                    }else if(!pPattern.test(pwd)){
                        alert("è¯·è¾“å…¥6-16ä½æ•°å¯†ç ï¼ˆæ•°å­—åŠ å­—æ¯ï¼‰ï¼");
                        return false;
                    }else if(!username.test(adminName)){
                        alert("è¯·è¾“å…¥è‹±æ–‡åç§°æˆ–ä¸­æ–‡ï¼");
                        return false;
                    }else if(!(/^1[34578]\d{9}$/.test(adminPhone))){
                        alert("æ‰‹æœºå·ç æœ‰è¯¯ï¼Œè¯·é‡å¡«");
                        return false;
                    } else if(adminAuthority=="è¯·é€‰æ‹©"){
                        alert("è¯·é€‰æ‹©ç®¡ç†å‘˜æƒé™");
                        return false;
                    }
                    $.ajax({
                        url:url,
                        type:'post',
                        async:false,
                        data:{
                            adminName:adminName,
                            adminAuthority:adminAuthority,
                            adminAccount:account,
                            adminPassword:pwd,
                            adminPhone:adminPhone
                        },
                        dataType:'text',
                        success:function(data){
                            var rs="è´¦æˆ· æ·»åŠ æˆåŠŸ";
                            if(data>0){
                                loadData(page,rows,stateId,condition);
                            }else{
                                rs="è´¦æˆ· æ·»åŠ å¤±è´¥";
                            }
                            //æç¤ºæ¡†è¿½åŠ ä¿¡æ¯ï¼Œå¹¶æ˜¾ç¤º
                            prompt(rs);
                            //å…³é—­è¡¨å•
                            $('#my_alert').css("display","none");
                            $(".am-dimmer").css("display","none");
                        }
                    });
                } else if(url=="/adminController/update"){ //ä¿®æ”¹
                    var adminId=$("#adminId").val();
                    if(!username.test(adminName)){
                        alert("è¯·è¾“å…¥ä¸­æ–‡åæˆ–è‹±æ–‡åï¼");
                        return false;
                    }else if(!(/^1[34578]\d{9}$/.test(adminPhone))){
                        alert("æ‰‹æœºå·ç æœ‰è¯¯ï¼Œè¯·é‡å¡«");
                        return false;
                    } else if(adminAuthority=="è¯·é€‰æ‹©"){
                        alert("è¯·é€‰æ‹©ç®¡ç†å‘˜æƒé™");
                        return false;
                    }
                    $.ajax({
                        url:url,
                        type:'post',
                        async:false,
                        data:{
                            adminId:adminId,
                            adminName:adminName,
                            adminAuthority:adminAuthority,
                            adminPhone:adminPhone
                        },
                        dataType:'text',
                        success:function(data){
                            var rs="è´¦æˆ· ä¿®æ”¹æˆåŠŸ";
                            if(data>0){
                                loadData(page,rows,stateId,condition);
                            }else{
                                rs="è´¦æˆ· ä¿®æ”¹å¤±è´¥";
                            }
                            //æç¤ºæ¡†è¿½åŠ ä¿¡æ¯ï¼Œå¹¶æ˜¾ç¤º
                            prompt(rs);
                            //å…³é—­è¡¨å•
                            $('#my_alert').css("display","none");
                            $(".am-dimmer").css("display","none");
                        }
                    });
                }
                return false;
            });
            $("#cancel").click(function(){
                //å…³é—­è¡¨å•
                $('#my_alert').css("display","none");
                $(".am-dimmer").css("display","none");
            });
        }

        //åˆå§‹åŒ–é¡µé¢
        loadData(page,rows,stateId,condition);

        /**
         * åŠ¨æ€å¤šæ¡ä»¶åˆ†é¡µæŸ¥è¯¢
         * @param page å½“å‰é¡µ
         * @param rows æ¯é¡µæ˜¾ç¤ºçš„æ•°é‡
         * @param stateId çŠ¶æ€Id
         * @param condition å…±åŒæ¡ä»¶
         */
        function loadData(page,rows,stateId,condition){
            $.ajax({
               url:'/adminController/PageQuery',
               type:'post',
               asyncs:false,
               data:{
                   page:page,
                   rows:rows,
                   stateId:stateId,
                   condition:condition
                },
                dataType:'json',
                success:function(data){
                   var total=data.total;
                   var lists=data.rows;
                   $("#content").empty();
                   for(var i=0;i<lists.length;i++) {
                      var str=("<tr>\n" +
                           "                                        <td class=\"am-hide-sm-only\">" + lists[i].adminId.substr(0, 8) + "...  </td>\n" +
                           "                                        <td>" + lists[i].adminName + "</td>\n" +
                           "                                        <td>" + lists[i].adminAccount + "</td>\n" +
                          "                                        <td>" + lists[i].adminPhone + "</td>\n" +
                          "                                        <td class=\"am-hide-sm-only\">" + lists[i].adminAuthority + "</td>\n" +
                           "                                        <td class=\"am-hide-sm-only\">" + lists[i].stateName + "</td>\n" +
                           "                                        <td class=\"am-hide-sm-only\">" + lists[i].admin2Name + "</td>\n" +
                           "                                        <td class=\"am-hide-sm-only\">" + lists[i].updateDate + "</td>\n" +
                           "                                        <td>\n" +
                           "                                            <div class=\"am-btn-toolbar\">\n" +
                           "                                                <div class=\"am-btn-group am-btn-group-xs\">\n" +
                           "                                                    <input type='hidden' class='adminId' value='" + lists[i].adminId + "'/>" +
                           "                                                    <button class=\"am-btn am-btn-default am-btn-xs am-text-secondary edit\"><span class=\"am-icon-pencil-square-o\"></span> ç¼–è¾‘</button>");
                       if(lists[i].stateName=="ç¦ç”¨"){
                          str+=("<input type=\"hidden\" value=\"66e75647-2b10-4553-a43d-2bb30fa33af7\"><button class=\"am-btn am-btn-default am-btn-xs am-text-danger am-hide-sm-only del\"><span class=\"am-icon-trash-o\"></span> æ¢å¤</button>" +
                               "                                                </div>\n" +
                               "                                            </div>\n" +
                               "                                        </td>\n" +
                               "                                    </tr>");
                       }else{
                           str+=("<input type='hidden' value='0df82e1d-c318-423f-b506-ef0ca2e628fe'><button class=\"am-btn am-btn-default am-btn-xs am-text-danger am-hide-sm-only del\"><span class=\"am-icon-trash-o\"></span> ç¦ç”¨</button>" +
                               "                                                </div>\n" +
                               "                                            </div>\n" +
                               "                                        </td>\n" +
                               "                                    </tr>");
                       }
                       $("#content").append(str);
                   }
                       /**
                        * ç¼–è¾‘ç‚¹å‡»äº‹ä»¶
                        */
                       $(".edit").click(function(){
                           var adminId=$(this).prev().val();
                           var adminName=$(this).parent().parent().parent().prev().prev().prev().prev().prev().prev().prev().text();
                           var adminAuthority=$(this).parent().parent().parent().prev().prev().prev().prev().text();
                           var adminPhone=$(this).parent().parent().parent().prev().prev().prev().prev().prev().text();
                           show_alert("ç¼–è¾‘ç®¡ç†å‘˜ä¿¡æ¯",formInfo(adminId,adminName,adminAuthority,adminPhone));
                           $("#accountDiv").css("display","none");
                           $("#pwdDiv").css("display","none");
                           url="/adminController/update";
                           return false;
                       });


                        $(".add").click(function(){
                            show_alert("ç¼–è¾‘ç®¡ç†å‘˜ä¿¡æ¯",formInfo("","","",""));
                            $("#accountDiv").css("display","block");
                            $("#pwdDiv").css("display","block");
                            url="/adminController/add";
                        });

                       /**
                        * ç¦ç”¨å’Œæ¢å¤ç‚¹å‡»äº‹ä»¶
                        */
                       $(".del").click(function(){
                           var adminId=$(this).parent().children("input").val();
                           var type=$(this).text();
                           $.ajax({
                               url:'/adminController/ByAdminIdUpdateState',
                               type:'post',
                               async:false,
                               data:{
                                   stateId:$(this).prev().val(), //ç¦ç”¨å¯¹åº”çš„id
                                   adminId:adminId
                               },
                               dataType:'text',
                               success:function(data){
                                   var rs="æˆåŠŸ";
                                    if(data>0){
                                        loadData(page,rows,stateId,condition);
                                    }else{
                                        rs="å¤±è´¥";
                                    }
                                   //æç¤ºæ¡†è¿½åŠ ä¿¡æ¯ï¼Œå¹¶æ˜¾ç¤º
                                   prompt("è´¦æˆ·"+type+rs);
                               }
                           });
                           return false;
                       });

                       /**
                        * åˆå§‹åŒ–åˆ†é¡µæ 
                        */
                       $("#paging_toolbar").empty();
                       $("#paging_toolbar").append("<li id=\"prev\"><a href=\"javascript:;\">Â«</a></li>");
                       for(var i=1;i<=total;i++){
                           if(page!=i){
                               $("#paging_toolbar").append("<li class='page'><a href=\"javascript:;\">"+i+"</a></li>");
                           }else{
                               $("#paging_toolbar").append("<li class=\"am-active page\"><a href=\"javascript:;\">"+i+"</a></li>");
                           }
                       }
                       $("#paging_toolbar").append("<li id='next'><a href=\"javascript:;\">Â»</a></li>");

                       /**
                        * ä¸Šä¸€é¡µç‚¹å‡»äº‹ä»¶
                        */
                       $("#prev").click(function(){
                           page=page-1;
                           if(page<1){
                               page=total;
                           }
                          loadData(page,rows,stateId,condition);
                       });

                       /**
                        * ä¸‹ä¸€é¡µç‚¹å‡»äº‹ä»¶
                        */
                       $("#next").click(function(){
                           page=page+1;
                           if(page>total){
                               page=1;
                           }
                           loadData(page,rows,stateId,condition);
                       });

                       /**
                        * é¡µæ•°ç‚¹å‡»äº‹ä»¶
                        */
                       $(".page").click(function(){
                           page=$(this).children("a").text();
                           loadData(page,rows,stateId,condition);
                       });

                }
            });
        }

        /**
         * æœç´¢æ¡†è¾“å…¥äº‹ä»¶ï¼šæ ¹æ®ç®¡ç†å‘˜åç§°å’Œå§“åæŸ¥è¯¢
         * */
        $("#search").keyup(function(){
           condition=$("#search").val();
           loadData(1,rows,stateId,condition);
        });

        /**
         * åˆå§‹åŒ–ä¸‹æ‹‰æ¡†
         */
        $.ajax({
           url:'/stateController/queryAll',
           type:'post',
           dataType:'json',
           asyncs:false,
           success:function(data){
               $("#selectState").empty();
               $("#selectState").append("<option class='op' value='0'>è¯·é€‰æ‹©çŠ¶æ€</option>");
               for(var i=0;i<data.length;i++){
                   $("#selectState").append("<option class='op' value='"+data[i].stateId+"'>"+data[i].stateName+"</option>\n");
               }
           }
        });


        /**
         * ä¸‹æ‹‰æ¡†é€‰æ‹©äº‹ä»¶ï¼šæ ¹æ®çŠ¶æ€æŸ¥è¯¢
         */
        $("#selectState").change(function () {
            stateId=$(this).val();
            if(stateId==0){
                stateId="";
            }
            loadData(1,rows,stateId,condition);
        });

        /**
         *  æ¸…ç©ºä¿®æ”¹å¯†ç formè¡¨å•ï¼Œå¹¶å…³é—­dialog
         * */
        function clearFormCloseDialog(){
            //æ¸…ç©ºè¡¨å•
            $("#oldPwd").val("");
            $("#newPwd").val("");
            //å…³é—­dialog
            $("#consumption_model").modal('close');
        }


        /**
         * ä¿®æ”¹å¯†ç ç‚¹å‡»äº‹ä»¶
         */
        $("#updatePwd").click(function(){
            $('#consumption_model').modal({
                relatedTarget: this,
               onCancel: function(e) {
                   clearFormCloseDialog();
                }
            });
        });

        /**
         * ä¿®æ”¹å¯†ç 
         */
        $("#subUpdatePwd").click(function(){
            var pPattern=/^(?![0-9]+$)(?![a-zA-Z]+$)[0-9A-Za-z]{6,16}$/; //å¯†ç ï¼š6-16ä½å­—æ¯åŠ æ•°å­—
            var oldPwd=$("#oldPwd").val();
            var newPwd=$("#newPwd").val();
            if(oldPwd==""){
                alert("è¯·è¾“å…¥åŸå¯†ç ");
                return false;
            }else if(!pPattern.test(newPwd)){
                alert("æ–°å¯†ç è¯·è¾“å…¥6-16ä½å­—æ¯åŠ æ•°å­—");
                return false;
            }
            $.ajax({
               url:'/adminController/updateAdminPassword',
               type:'post',
               data:{
                   oldPwd:oldPwd,
                   newPwd:newPwd
               },
               dataType:'text',
               success:function(data){
                    alert(data);
                    if(data=="ä¿®æ”¹æˆåŠŸï¼Œè¯·é‡æ–°ç™»é™†"){
                        window.location.href="/adminController/Exit";
                    }
               }
            });
           return false;
        });

    });
</script>